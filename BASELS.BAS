  1 WIDTH 80 :REM
  2 USEVAR A1
  3 GOSUB INIRND :REM
  5 GOSUB TAB,33:PRINT "BASELS" :REM
 10 GOSUB TAB,15:PRINT "CREATIVE COMPUTING MORRISTOWN, NEW JERSEY" :REM
 15 REM *. BAGLES NUMBER GUESSING GANE
 20 REM *** ORIGINAL SOURCE UNKNOUN BUT SUSPECTED TO BE
 25 REM *** LAVRENCE HALL OF SCIENCE, U.C. BERKELY
 30 DIM A1(6),A(3),B(3)
 40 Y=0:T=255
 50 PRINT:PRINT:PRINT
 70 PRINT "WOULD YOU LIKE THE RULES (YES OR NO)"; :REM
 80 P$=INPUT$() :REM
 90 IF STRNCMP(GOSUB$(LEFT, P$,1),"N",1)=0 THEN 150 :REM
100 PRINT:PRINT "I AN THINKING OF A THREE-DIGIT NUMBER. TRY TO GUESS"
110 PRINT "MY MUMBER AND I WILL GIVE YOU CLUES AS FOLLOUS:"
120 PRINT "    PICO   - ONE DIGIT CORRECT BUT IN THE WRONG POSITION"
130 PRINT "    FERMI  - ONE DIGIT CORRECT AND IN THE RIGHT POSITION"
140 PRINT "    BAGELS - NO DIGITS CORRECT"
150 FOR I=1 TO 3
160   A(I)=INT(10*GOSUB#(RND_,1)) :REM
165   IF I-1=0 THEN 200
170   FOR J=1 TO I-1
180     IF A(I)=A(J) THEN 160
190   NEXT :REM
200 NEXT :REM
210 PRINT:PRINT "O.K. I HAVE A NUMBER IN MIND."
220 FOR I=1 TO 20
230   PRINT "GUESS #";I,
240   P$=INPUT$() :REM
245   IF LEN(P$)!=3 THEN 630 :REM
250   FOR Z=1 TO 3 REM
252     A1(Z)=ASC(GOSUB$(MID, P$,Z,1)) :REM
254   NEXT :REM
260   FOR J=1 TO 3
270     IF A1(J)<48 THEN 300
280     IF A1(J)>57 THEN 300
285     B(J)=A1(J)-48
290   NEXT :REM
295   GOTO 320
300   PRINT "WHAT?"
310   GOTO 230
320   IF B(1)=B(2) THEN 650
330   IF B(2)=B(3) THEN 650
340   IF B(3)=B(1) THEN 650
350   C=0:D=0
360   FOR J=1 TO 2
370     IF A(J)!=B(J+1) THEN 390
380     C=C+1
390     IF A(J+1)!=B(J) THEN 410
400     C=C+1
410   NEXT :REM
420   IF A(1)!=B(3) THEN 440
430   C=C+1
440   IF A(3)!=B(1) THEN 460
450   C=C+1
460   FOR J=1 TO 3
470     IF A(J)!=B(J) THEN 490
480     D=D+1
490   NEXT :REM
500   IF D=3 THEN 680
505   IF C=0 THEN 545
520   FOR J=1 TO C
530     PRINT "PICO ";
540   NEXT :REM
545   IF D=0 THEN 580
550   FOR J=1 TO D
560     PRINT "FERMI ";
570   NEXT :REM
580   IF C*D!=0 THEN 600
590   PRINT "BAGELS ";
600   PRINT
605 NEXT :REM
610 PRINT "OH WELL"
615 PRINT "THAT'S TWENTY GUESSES. NY NUMBER WAS";100*A(1)+10+A(2)+A(3)
620 GOTO 700
630 PRINT "TRY GUESSING A THREE-DIOIT NUMBER.":GOTO 230
650 PRINT "OH, I FORGOT TO TELL YOU THAT THE NUMBER I HAVE IN MIND"
660 PRINT "HAS NO TWO DIGITS THE SAME.":GOTO 230
680 PRINT "YOU GOT IT!!!":PRINT
690 Y=Y+1
700 PRINT "PLAY AGAIN (YES OR NO)"; :REM
701 P$=INPUT$() :REM
720 IF STRNCMP(P$,"Y",1)=0 THEN 150 REM
730 IF Y=0 THEN 750
740 PRINT:PRINT "A";Y;"POINT BAGELS BUFF!!"
750 PRINT "HOPE YOU HAD FUN. BYE."
999 END


REM Subroutines For MachiKania

LABEL LEFT
VAR X,Y,R
X$=ARGS$(1)
Y=ARGS(2)
R$=X$(0,Y)
RETURN R$

LABEL MID
VAR X,Y,Z
X$=ARGS$(1)
Y=ARGS(2)-1
Z=ARGS(3)
R$=X$(Y,Z)
RETURN R$

LABEL RIGHT
VAR X,Y,R
X$=ARGS$(1)
Y=ARGS(2)
R$=X$(-1,Y)
RETURN R$

LABEL TAB
VAR I,J
J=ARGS(1)
FOR I=0 TO J-1
  PRINT " ";
NEXT
RETURN

LABEL INIRND
POKE32 SYSTEM(101),CORETIMER()
RETURN

LABEL RND_
VAR I,J
I=ARGS(1)
J#=FLOAT#(RND()*I)/32767
RETURN J#
